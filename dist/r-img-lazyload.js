!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var n="object"==typeof exports?t(require("react")):t(e.React);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof window,o=function(e,t){return"undefined"!=typeof getComputedStyle?getComputedStyle(e,null).getPropertyValue(t):e.style[t]},i=function(e){return o(e,"overflow")+o(e,"overflow-y")+o(e,"overflow-x")};var a={on:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(){if(!r)return!1;var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return e}()?e.addEventListener(t,n,o):e.addEventListener(t,n,{capture:o,passive:!0})},off:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.removeEventListener(t,n,r)}};t.throttle=function(e,t){var n=null,r=0;return function(){if(!n){var o=this,i=arguments,a=function(){r=Date.now(),n=!1,e.apply(o,i)};Date.now()-r>=t?a():n=setTimeout(a,t)}}},t.remove=function(e,t){if(e.length){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},t.style=o,t.inBrowser=r,t.eventRegister=a,t.scrollParent=function(e){if(!r)return!1;if(!(e instanceof HTMLElement))return window;for(var t=e;t&&t!==document.body&&t!==document.documentElement&&t.parentNode;){if(/(scroll|auto)/.test(i(t)))return t;t=t.parentNode}return window},t.loadImageAsync=function(e,t,n){if(e.src){var r=new Image;r.src=e.src,r.onload=function(){t({naturalHeight:r.naturalHeight,naturalWidth:r.naturalWidth,src:r.src})},r.onerror=function(e){n(e)}}else n("img path is require")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=a(o);function a(e){return e&&e.__esModule?e:{default:e}}var u=new(a(n(3)).default),s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentDidMount=function(){u.add({el:n.refs.lazyImg,src:n.props.src,backgroundImage:!!n.props.tag,options:n.props.options})},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"render",value:function(){return this.props.tag?i.default.createElement(this.props.tag,{ref:"lazyImg",className:this.props.className,onClick:this.props.onClick}):i.default.createElement("img",{className:this.props.className,onClick:this.props.onClick,ref:"lazyImg"})}},{key:"shouldComponentUpdate",value:function(e){return u.update({el:this.refs.lazyImg,src:e.src,backgroundImage:!!e.tag,options:e.options}),!0}},{key:"componentWillUnmount",value:function(){u.remove(this.refs.lazyImg)}}]),t}();t.default=s},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(n(4));var u="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultOptions={throttleWait:200,preLoad:1.3,listenEvents:["scroll","wheel","mousewheel","resize","animationend","transitionend","touchmove"],error:u,loading:u},this.ListenerQueue=[],this.TargetQueue=[],this.lazyLoadHandler=(0,i.throttle)(this.$lazyLoadHandler.bind(this),this.defaultOptions.throttleWait)}return o(e,[{key:"inintOptions",value:function(e){this.defaultOptions=r({},this.defaultOptions,e)}},{key:"add",value:function(e){var t=e.el,n=e.src,o=e.backgroundImage,u=e.options,s=void 0===u?{}:u;if(this.ListenerQueue.some(function(e){return e.el===t}))this.update({el:t,src:n,backgroundImage:o,options:s});else{this.inintOptions(s);var l=(0,i.scrollParent)(t),c=new a.default({el:t,src:n,$parent:l,elRenderer:this.elRenderer,options:r({},this.defaultOptions,{backgroundImage:o})});this.ListenerQueue.push(c),i.inBrowser&&(this.addListenerTarget(window),this.addListenerTarget(l)),this.lazyLoadHandler()}}},{key:"update",value:function(e){var t=e.el,n=e.src,o=e.backgroundImage,i=e.options,a=void 0===i?{}:i,u=this.ListenerQueue.find(function(e){return e.el===t});this.inintOptions(a),u&&u.updata({src:n,options:r({},this.defaultOptions,{backgroundImage:o})}),this.lazyLoadHandler()}},{key:"remove",value:function(e){if(e){var t=this.ListenerQueue.find(function(t){return t.el===e});t&&(this.removeListenerTarget(t.$parent),this.removeListenerTarget(window),(0,i.remove)(this.ListenerQueue,t))}}},{key:"addListenerTarget",value:function(e){var t=this.TargetQueue.find(function(t){return t.el===e});t?++t.childrenCount:(t={el:e,childrenCount:1},this.initListener(t.el,!0),this.TargetQueue.push(t))}},{key:"removeListenerTarget",value:function(e){var t=this;this.TargetQueue.forEach(function(n,r){n.el===e&&(--n.childrenCount,n.childrenCount||(t.initListener(n.el,!1),t.TargetQueue.splice(r,1),n=null))})}},{key:"initListener",value:function(e,t){var n=this;this.defaultOptions.listenEvents.forEach(function(r){i.eventRegister[t?"on":"off"](e,r,n.lazyLoadHandler)})}},{key:"elRenderer",value:function(e,t){var n=e.el,r=void 0;switch(t){case"loading":r=e.loading;break;case"error":r=e.error;break;default:r=e.src}e.options.backgroundImage?n.style.backgroundImage="url("+r+")":n.getAttribute("src")!==r&&n.setAttribute("src",r),n.setAttribute("lazy",t)}},{key:"$lazyLoadHandler",value:function(){this.ListenerQueue.forEach(function(e){!e.loaded&&e.checkInView()&&e.load()})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0);var i={},a=function(){function e(t){var n=t.el,r=t.src,o=t.$parent,i=t.elRenderer,a=t.options;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=n,this.src=r,this.error=a.error,this.loading=a.loading,this.$parent=o,this.options=a,this.elRenderer=i,this.initStatus(),this.render("loading")}return r(e,[{key:"initStatus",value:function(){this.status={error:!1,loaded:!1}}},{key:"load",value:function(){var e=this;this.status.error||((this.status.loaded||i[this.src])&&this.render("loaded"),(0,o.loadImageAsync)({src:this.src},function(){e.status.loaded=!0,e.status.error=!1,e.render("loaded"),i[e.src]=!0},function(t){e.status.loaded=!1,e.status.error=!0,e.render("error")}))}},{key:"updata",value:function(e){var t=e.src,n=e.options,r=this.src;this.src=t,this.loading=n.loading,this.error=n.error,this.options=n,r!==this.src&&this.initStatus()}},{key:"render",value:function(e){this.elRenderer(this,e)}},{key:"getRect",value:function(){this.rect=this.el.getBoundingClientRect()}},{key:"checkInView",value:function(){return this.getRect(),this.rect.top<window.innerHeight*this.options.preLoad&&this.rect.bottom>0&&this.rect.left<window.innerWidth*this.options.preLoad&&this.rect.right>0}}]),e}();t.default=a}])});
//# sourceMappingURL=r-img-lazyload.js.map